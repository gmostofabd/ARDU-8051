<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>8051 Virtual Lab | 7-Segment Display</title>

<style>
:root{
  --primary:#1f3c88;
  --accent:#0a9396;
  --dark:#222;
}

body{
  margin:0;
  font-family:Segoe UI,Roboto,Arial,sans-serif;
  background:#f7f9fc;
  color:var(--dark);
}

header{
  background:linear-gradient(135deg,var(--primary),var(--accent));
  color:#fff;
  padding:2.2rem 1rem;
  text-align:center;
}

section{
  max-width:1100px;
  margin:auto;
  padding:2rem 1.5rem;
}

h2{
  color:var(--primary);
  border-bottom:2px solid #ddd;
  padding-bottom:.3rem;
}

/* ================= LAB LAYOUT ================= */
.lab-wrapper{
  background:#fff;
  padding:1.5rem;
  border-radius:14px;
  box-shadow:0 8px 22px rgba(0,0,0,.15);
}

.lab-container{
  display:flex;
  gap:1.5rem;
  flex-wrap:wrap;
}

.lab-left,.lab-right{
  flex:1 1 420px;
}

/* ================= CODE ================= */
.lab-code{
  background:#1e1e1e;
  color:#00ff90;
  padding:1rem;
  border-radius:8px;
  font-family:Consolas,monospace;
  font-size:14px;
  white-space:pre;
}

.lab-highlight{
  background:#ffee58;
  color:#000;
}

/* ================= BUTTONS ================= */
button{
  background:var(--primary);
  color:#fff;
  border:none;
  padding:.45rem 1rem;
  border-radius:6px;
  cursor:pointer;
  margin:.3rem .2rem;
}
button:hover{background:var(--accent)}

/* ================= 7 SEGMENT ================= */
.seven-seg{
  width:140px;
  margin:1rem auto;
  position:relative;
}

.seg{
  position:absolute;
  background:#400;
  opacity:.2;
  transition:.2s;
}
.seg.on{
  background:red;
  opacity:1;
  box-shadow:0 0 10px red;
}

/* segment positions */
.seg.a{top:0;left:30px;width:80px;height:12px}
.seg.b{top:10px;right:0;width:12px;height:60px}
.seg.c{bottom:10px;right:0;width:12px;height:60px}
.seg.d{bottom:0;left:30px;width:80px;height:12px}
.seg.e{bottom:10px;left:0;width:12px;height:60px}
.seg.f{top:10px;left:0;width:12px;height:60px}
.seg.g{top:66px;left:30px;width:80px;height:12px}

/* ================= PANEL ================= */
.panel{
  background:#eef2f7;
  padding:.6rem;
  border-radius:6px;
  font-family:monospace;
  margin-top:.6rem;
}
</style>
</head>

<body>

<header>
  <h1>8051 Virtual Lab</h1>
  <p>7-Segment Display using Assembly Language</p>
</header>

<section>
<h2>ðŸ§ª Experiment: 7-Segment Display (Common Cathode)</h2>

<div class="lab-wrapper">

<div class="lab-container">

<!-- ================= LEFT ================= -->
<div class="lab-left">

<pre id="code" class="lab-code">
ORG 0000H
MOV DPTR,#TABLE
MOV R0,#00H

NEXT:
MOV A,R0
MOVC A,@A+DPTR
MOV P1,A
INC R0
CJNE R0,#10,NEXT
MOV R0,#00H
SJMP NEXT

TABLE:
DB 3FH,06H,5BH,4FH
DB 66H,6DH,7DH,07H
DB 7FH,6FH
END
</pre>

<button onclick="step()">Step</button>
<button onclick="run()">Run</button>
<button onclick="resetLab()">Reset</button>

<div class="panel">
P1 = <span id="p1bin">00000000</span> (0x<span id="p1hex">00</span>)<br>
Digit = <span id="digit">0</span>
</div>

</div>

<!-- ================= RIGHT ================= -->
<div class="lab-right">

<div class="seven-seg">
  <div class="seg a"></div>
  <div class="seg b"></div>
  <div class="seg c"></div>
  <div class="seg d"></div>
  <div class="seg e"></div>
  <div class="seg f"></div>
  <div class="seg g"></div>
</div>

<div class="panel">
Segment Mapping (P1):<br>
a b c d e f g<br>
P1.0 â†’ a, P1.6 â†’ g
</div>

</div>

</div>
</div>
</section>

<script>
/* ================= ASSEMBLY LOGIC ================= */
const table=[
  0x3F,0x06,0x5B,0x4F,
  0x66,0x6D,0x7D,0x07,
  0x7F,0x6F
];

const segments=["a","b","c","d","e","f","g"];
let digit=0;
let runner=null;

function updateDisplay(val){
  segments.forEach((s,i)=>{
    document.querySelector(".seg."+s)
      .classList.toggle("on",(val>>i)&1);
  });
}

function updatePanel(val){
  document.getElementById("p1bin").textContent=
    val.toString(2).padStart(8,"0");
  document.getElementById("p1hex").textContent=
    val.toString(16).toUpperCase().padStart(2,"0");
  document.getElementById("digit").textContent=digit;
}

function step(){
  const val=table[digit];
  updateDisplay(val);
  updatePanel(val);
  digit=(digit+1)%10;
}

function run(){
  if(runner) return;
  runner=setInterval(step,900);
}

function resetLab(){
  clearInterval(runner);
  runner=null;
  digit=0;
  updateDisplay(0);
  updatePanel(0);
}

resetLab();
</script>

</body>
</html>
